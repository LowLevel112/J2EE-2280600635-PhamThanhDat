<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initialscale=1.0" />
    <title>Cart</title>
    <th:block th:replace="~{layout::link-css}"></th:block>
    <th:block th:replace="~{layout::custom-css}"></th:block>
  </head>

  <body>
    <th:block th:replace="~{layout::header}"></th:block>
    <div class="container" th:if="${not #lists.isEmpty(cart.cartItems)}">
      <div class="row mt-5 mb-3">
        <div class="col-12">
          <h2><i class="fas fa-shopping-cart"></i> Your Shopping Cart</h2>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-dark">
            <tr>
              <th scope="col">Image</th>
              <th scope="col">Book ID</th>
              <th scope="col">Book Name</th>
              <th scope="col">Quantity</th>
              <th scope="col">Price</th>
              <th scope="col">Total</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="item : ${cart.cartItems}">
              <td>
                <img
                  th:if="${item.imageUrl}"
                  th:src="${item.imageUrl}"
                  alt="Book Cover"
                  style="
                    max-height: 50px;
                    max-width: 35px;
                    object-fit: cover;
                    border-radius: 3px;
                  "
                />
                <i
                  th:unless="${item.imageUrl}"
                  class="fas fa-book"
                  style="font-size: 30px; color: #ccc"
                ></i>
              </td>
              <td th:text="${item.getBookId()}"></td>
              <td>
                <strong th:text="${item.getBookName()}"></strong>
              </td>
              <td>
                <input
                  type="number"
                  min="1"
                  th:value="${item.getQuantity()}"
                  th:attr="data-id=${item.getBookId()}"
                  class="form-control quantity"
                  style="max-width: 70px"
                />
              </td>
              <td>
                $<span
                  th:text="${#numbers.formatDecimal(item.getPrice(), 1, 2)}"
                ></span>
              </td>
              <td>
                $<span
                  th:text="${#numbers.formatDecimal(item.getPrice() * item.getQuantity(), 1, 2)}"
                ></span>
              </td>
              <td>
                <a
                  class="btn btn-danger btn-sm"
                  th:href="@{/cart/removeFromCart/{id}(id=${item.getBookId()})}"
                >
                  <i class="fas fa-trash"></i> Remove
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="row mt-4">
        <div class="col-md-12">
          <div class="card">
            <div class="card-body">
              <h4 class="card-title">Cart Summary</h4>
              <h3 class="text-primary">
                Total:
                <strong
                  >$<span
                    th:text="${#numbers.formatDecimal(totalPrice, 1, 2)}"
                  ></span
                ></strong>
              </h3>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-3 mb-5">
        <div class="col-md-12 text-right">
          <a class="btn btn-success btn-lg" th:href="@{/cart/checkout}"
            ><i class="fas fa-credit-card"></i> Checkout</a
          >
          <a class="btn btn-warning btn-lg" href="/books"
            ><i class="fas fa-shopping-bag"></i> Continue Shopping</a
          >
          <a class="btn btn-danger btn-lg" th:href="@{/cart/clearCart}"
            ><i class="fas fa-trash"></i> Clear Cart</a
          >
        </div>
      </div>
    </div>
    <div class="container" th:if="${#lists.isEmpty(cart.cartItems)}">
      <div class="container">
        <div class="row">
          <div class="col-md-6 offset-md-3 text-center">
            <h3 class="mt-5">Your cart is empty</h3>
            <p class="lead">Please add some books to your cart</p>
            <a class="btn btn-primary" href="/books">Go to list book</a>
          </div>
        </div>
      </div>
    </div>
    <th:block th:replace="~{layout::footer}"></th:block>
    <script th:src="@{/js/cart.js}"></script>
  </body>
</html>
